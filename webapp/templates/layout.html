<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="{{ app_data['description'] }}">
    <meta name="keywords" content="{{ app_data['keywords'] }}">
    <meta name="author" content="{{ app_data['author'] }}">
  <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}">

    <title>{{ app_data['html_title'] }}</title>

  <!-- Bootstrap core CSS -->
  <!-- TODO(self-host): Move external CDN assets into static/vendor for stricter CSP -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
  <link href="{{ url_for('static', filename='style.css') }}" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
  <!-- Example logo usage -->
    <style>
      :root {
        --sq-bg: #f8fafc;
        --sq-surface: #ffffff;
        --sq-border: #e2e8f0;
        --sq-accent: #0d6efd;
        --sq-accent-rgb: 13,110,253;
        --sq-radius: .75rem;
        --sq-text: #1e293b;
        --sq-muted: #64748b;
        --sq-code-bg: #f1f5f9;
      }
      body { background: var(--sq-bg); color: var(--sq-text); }
      #link { background-color: var(--sq-code-bg); color: var(--sq-text); }
      details#advancedSettings summary { cursor: pointer; user-select:none; }
      .sq-form-card { background: var(--sq-surface); border:1px solid var(--sq-border); border-radius: var(--sq-radius); padding:1.25rem; }
      .sq-results-card .card-body { background: var(--sq-surface); }
      .sq-actions .btn { width:100%; }
      @media (min-width: 576px){ .sq-actions .btn { width:auto; } }
      .sq-small { font-size: .75rem; color: var(--sq-muted);} 
      .theme-toggle { position: fixed; bottom:1rem; right:1rem; }
  </style>
  </head>

  <body>

    {% include 'includes/_navbar.html' %}

    <main role="main" class="container py-3">
        {% block body %}{% endblock %}
    </main>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js" integrity="sha384-mQ93GR66B00ZXjt0YO5KlohRA5SY2XofN4zfuZxLkoj1gXtW8ANNCe9d5Y3eG5eD" crossorigin="anonymous"></script>

    <script>
      // Enable/Disable Slider based on the Form Switch state
      $(document).ready(function () {
          $('#enableSliderSwitch').change(function () {
              if ($(this).is(':checked')) {
                  $('#exampleRange').prop('disabled', true);
              } else {
                  $('#exampleRange').prop('disabled', false);
              }
          });
          // Display the current value of the slider
        $('#exampleRange').on('input', function () {
            $('#sliderValue').text('Current Value: ' + $(this).val());
        });
      });
       // JavaScript to trigger the download
  // Wrap dynamic behaviors so missing elements don't break other scripts
  document.addEventListener('DOMContentLoaded', function () {
    var dlBtn = document.getElementById('downloadBtn');
    if (dlBtn) {
      dlBtn.addEventListener('click', function() {
        var img = document.getElementById('qrImage');
        if (!img) return;
        var link = document.createElement('a');
        link.href = img.src;
        link.download = 'qrcode.png';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      });
    }

                            const autoSwitch = document.getElementById('enableSliderSwitch');
                            const range = document.getElementById('exampleRange');
                            const lbl = document.getElementById('sliderValue');
                            function sync() {
                                if (autoSwitch.checked) {
                                    range.disabled = true;
                                    range.value = 0;
                                    lbl.textContent = 'Current Value: Automatic';
                                } else {
                                    range.disabled = false;
                                    lbl.textContent = 'Current Value: ' + range.value;
                                }
                            }
                            autoSwitch.addEventListener('change', sync);
                            range.addEventListener('input', () => {
                                if (!autoSwitch.checked) lbl.textContent = 'Current Value: ' + range.value;
                            });
                            sync();
    // Rotate chevron for <details> using attribute observer fallback (Safari <= 15 lacks ::marker control)
    const adv = document.getElementById('advancedSettings');
    if (adv) {
      const chev = adv.querySelector('.chevron');
      function syncChevron(){
        if (!chev) return;
        chev.style.transform = adv.hasAttribute('open') ? 'rotate(90deg)' : 'rotate(0deg)';
      }
      adv.addEventListener('toggle', syncChevron);
      syncChevron();
    }

    // Copy button
    const copyBtn = document.getElementById('copyBtn');
    if (copyBtn) {
      copyBtn.addEventListener('click', function(){
        const img = document.getElementById('qrImage');
        if (!img) return;
        const base64 = img.getAttribute('src');
        navigator.clipboard.writeText(base64).then(()=>{
          copyBtn.textContent = 'Copied!';
          setTimeout(()=> copyBtn.textContent='Copy PNG (Base64)', 1800);
        });
      });
    }

    // Submit spinner
    const form = document.getElementById('qrForm');
    const submitBtn = document.getElementById('submitBtn');
    const submitSpinner = document.getElementById('submitSpinner');
    if (form && submitBtn && submitSpinner) {
      form.addEventListener('submit', function(){
        submitBtn.disabled = true;
        submitSpinner.classList.remove('d-none');
      });
    }
    });
  </script>
  </body>
</html>